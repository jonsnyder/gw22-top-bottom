/**
 * Copyright 2019 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

!function(){"use strict";if(document.documentMode&&document.documentMode<11)console.warn("The Adobe Experience Cloud Web SDK does not support IE 10 and below.");else{var e="Chrome",n="Edge",t="EdgeChromium",r="Unknown",o=function(e,n){return-1!==e.indexOf(n)},i=[e,n,t,"IE",r],a=function(e){return o(i,e)},c=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,d=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(n).map((function(e){return n[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,n){for(var t,r,o=bi(e),i=1;i<arguments.length;i++){for(var a in t=Object(arguments[i]))u.call(t,a)&&(o[a]=t[a]);if(c){r=c(t);for(var d=0;d<r.length;d++)s.call(t,r[d])&&(o[r[d]]=t[r[d]])}}return o},f=d,l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g=Ci((function(e,n){var t;t=function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function t(r){function o(){}function i(n,t,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(t);/^[\{\[]/.test(a)&&(t=a)}catch(e){}t=r.write?r.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var c="";for(var u in i)i[u]&&(c+="; "+u,!0!==i[u]&&(c+="="+i[u].split(";")[0]));return document.cookie=n+"="+t+c}}function a(e,t){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var c=i[a].split("="),u=c.slice(1).join("=");t||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var s=n(c[0]);if(u=(r.read||r)(u,s)||n(u),t)try{u=JSON.parse(u)}catch(e){}if(o[s]=u,e===s)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return a(e,!1)},o.getJSON=function(e){return a(e,!0)},o.remove=function(n,t){i(n,"",e(t,{expires:-1}))},o.defaults={},o.withConverter=t,o}((function(){}))},e.exports=t()})),p={get:g.get,set:g.set,remove:g.remove};p.get,p.set,p.remove;var v=function(e){return null==e},m=function(e){return!v(e)&&!Array.isArray(e)&&"object"===Di(e)},h=function e(n,t){Object.keys(t).forEach((function(r){m(n[r])&&m(t[r])?e(n[r],t[r]):n[r]=t[r]}))},y=function(e){if(v(e))throw new TypeError('deepAssign "target" cannot be null or undefined');for(var n=Object(e),t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.forEach((function(e){return h(n,Object(e))})),n},w=function(e,n){return function(t){var r=n.split(".").reduce((function(e,n){return e[n]=e[n]||{},e[n]}),e);y(r,t)}},b=function(){var e=[];return{add:function(n){e.push(n)},call:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return Promise.all(e.map((function(e){return e.apply(void 0,t)})))}}},C=function(e){var n=e.logger,t=e.cookieJar;return Ii(Ii({},t),{},{set:function(e,r,o){n.info("Setting cookie",Ii({name:e,value:r},o)),t.set(e,r,o)}})},E=function(){for(var e=[],n=0;n<256;n++){for(var t=n,r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e.push(t)}return function(n,t){n=unescape(encodeURIComponent(n)),t||(t=0),t^=-1;for(var r=0;r<n.length;r++){var o=255&(t^n.charCodeAt(r));t=t>>>8^e[o]}return(t^=-1)>>>0}}(),I=function(){var e={};return e.promise=new Promise((function(n,t){e.resolve=n,e.reject=t})),e},D=function(e,n){for(var t=0;t<e.length;t+=1){var r=e[t];if(n(r,t,e))return r}},R=function(e,n){return e.appendChild(n)},S=function(e,n){Object.keys(n).forEach((function(t){if("style"===t&&m(n[t])){var r=n[t];Object.keys(r).forEach((function(n){e.style[n]=r[n]}))}else e[t]=n[t]}))},O=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document,i=o.createElement(e);return Object.keys(n).forEach((function(e){i.setAttribute(e,n[e])})),S(i,t),r.forEach((function(e){return R(i,e)})),i},k="BODY",P="IFRAME",q="IMG",x="STYLE",M="SCRIPT",A=function(e){var n=e.src,t=e.currentDocument,r=void 0===t?document:t;return new Promise((function(e,t){O(q,{src:n},{onload:e,onerror:t,onabort:t},[],r)}))},N=function(e){return"function"==typeof e},T=function(e){return Array.isArray(e)&&e.length>0},j=function(e){return Array.isArray(e)?e:null==e?[]:[].slice.call(e)},U=/^\s*>/,F=function(e,n){if(!U.test(n))return j(e.querySelectorAll(n));var t="alloy-"+Date.now();try{return e.classList.add(t),j(e.querySelectorAll("."+t+" "+n))}finally{e.classList.remove(t)}},B=function(e,n){return e.substr(0,n.length)===n},H=":shadow",_=function(e,n){var t=n.trim();return B(t,">")?window.document.documentMode?t.substring(1).trim():(e instanceof Element||e instanceof HTMLDocument?":scope":":host")+" "+t:t},L=function(e,n){if(!window.document.documentElement.attachShadow)return F(e,n.replace(H,""));var t=function(e){return e.split(H)}(n);if(t.length<2)return F(e,n);for(var r=e,o=0;o<t.length;o+=1){var i=_(r,t[o]),a=F(r,i);if(0===a.length||!a[0]||!a[0].shadowRoot)return a;r=a[0].shadowRoot}},V=function(e){return-1!==e.indexOf(H)},z=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return V(e)?L(n,e):F(n,e)},J={childList:!0,subtree:!0},W=function(e){return new Error("Could not find: "+e)},Q=function(e){return new Promise(e)},X=function(e){return N(e.MutationObserver)},$=function(e,n,t,r,o){return Q((function(i,a){var c=new e.MutationObserver((function(){var e=o(t);T(e)&&(c.disconnect(),i(e))}));setTimeout((function(){c.disconnect(),a(W(t))}),r),c.observe(n,J)}))},G=function(e){return"visible"===e.visibilityState},K=function(e,n,t,r){return Q((function(o,i){!function t(){var i=r(n);T(i)?o(i):e.requestAnimationFrame(t)}(),setTimeout((function(){i(W(n))}),t)}))},Y=function(e,n,t){return Q((function(r,o){!function n(){var o=t(e);T(o)?r(o):setTimeout(n,100)}(),setTimeout((function(){o(W(e))}),n)}))},Z=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document,i=n(e);return T(i)?Promise.resolve(i):X(r)?$(r,o,e,t,n):G(o)?K(r,e,t,n):Y(e,t,n)},ee=function(e){var n=e.parentNode;return n?n.removeChild(e):null},ne={name:"Adobe Alloy"},te={style:{display:"none",width:0,height:0}},re=function(e){return m(e)&&0===Object.keys(e).length},oe=function e(n,t){return v(n)||!m(n)?n:Object.keys(n).reduce((function(r,o){var i=n[o];if(m(i)){var a=e(i,t);return re(a)?r:Ii(Ii({},r),{},Ri({},o,a))}return t(i)?Ii(Ii({},r),{},Ri({},o,i)):r}),{})},ie=function(e,n){return Array.prototype.concat.apply([],e.map(n))},ae="com.adobe.alloy.",ce=ae+"getTld",ue=function(e){return e.replace("@","_")},se=function(e,n){return"kndctr_"+ue(e)+"_"+n},de=function(e){var n=e.orgId,t=se(n,"identity");return function(){return Boolean(p.get(t))}},fe=function(e,n,t){return{getItem:function(r){try{return e[n].getItem(t+r)}catch(e){return null}},setItem:function(r,o){try{return e[n].setItem(t+r,o),!0}catch(e){return!1}},clear:function(){try{return Object.keys(e[n]).forEach((function(r){B(r,t)&&e[n].removeItem(r)})),!0}catch(e){return!1}}}},le=function(e,n){return e.filter((function(e){return o(n,e)}))},ge=function(e){return"boolean"==typeof e},pe=function(e){return"number"==typeof e&&!isNaN(e)},ve=function(e){var n=parseInt(e,10);return pe(n)&&e===n},me=function(e){return"string"==typeof e},he=function(e){return me(e)&&e.length>0},ye=function(){},we=function(e,n,t){var r=String(e),o=String(t);if(r.length>=n||0===o.length)return r;for(var i=n-r.length;i>o.length;)o+=o;return o.slice(0,i)+r},be=function(e){if(v(e)||"object"!==Di(e))return null;var n=oe(e,(function(e){return!v(e)&&(!!ge(e)||(!!pe(e)||(!!he(e)||!!T(e))))}));return re(n)?null:n},Ce=function(e,n,t,r){n=n||"&",t=t||"=";var o={};if("string"!=typeof e||0===e.length)return o;var i=/\+/g;e=e.split(n);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var u=0;u<c;++u){var s,d,f,l,g=e[u].replace(i,"%20"),p=g.indexOf(t);p>=0?(s=g.substr(0,p),d=g.substr(p+1)):(s=g,d=""),f=decodeURIComponent(s),l=decodeURIComponent(d),xi(o,f)?Array.isArray(o[f])?o[f].push(l):o[f]=[o[f],l]:o[f]=l}return o},Ee=function(e){switch(Di(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},Ie=function(e,n,t,r){return n=n||"&",t=t||"=",null===e&&(e=void 0),"object"===Di(e)?Object.keys(e).map((function(r){var o=encodeURIComponent(Ee(r))+t;return Array.isArray(e[r])?e[r].map((function(e){return o+encodeURIComponent(Ee(e))})).join(n):o+encodeURIComponent(Ee(e[r]))})).join(n):r?encodeURIComponent(Ee(r))+t+encodeURIComponent(Ee(e)):""},De=Ci((function(e,n){n.decode=n.parse=Ce,n.encode=n.stringify=Ie}));De.decode,De.parse,De.encode,De.stringify;for(var Re=function(e){return"string"==typeof e&&(e=e.trim().replace(/^[?#&]/,"")),De.parse(e)},Se=function(e){return De.stringify(e)},Oe=function(e){return e instanceof Error?e:new Error(e)},ke=function(e){var n=e.error,t=e.message;try{n.message=t}catch(e){}},Pe=function(e){var n=e.error,t=e.message,r=Oe(n),o=t+"\nCaused by: "+r.message;return ke({error:r,message:o}),r},qe=function(e,n){var t=Math.round(Number(e));return isNaN(t)?n:t},xe=Ci((function(e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var r=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),r[n]=e>>>((3&n)<<3)&255;return r}}})),Me=[],Ae=0;Ae<256;++Ae)Me[Ae]=(Ae+256).toString(16).substr(1);var Ne=function(e,n){var t=n||0,r=Me;return[r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]]].join("")},Te=function(e,n,t){var r=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||xe)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n)for(var i=0;i<16;++i)n[r+i]=o[i];return n||Ne(o)},je=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(t,r){return n(e(t,r),r)};return f(r,e,t),r},Ue=function(e,n,t){return je(e,(function(e,t){return null==e?e:n(e,t)}),t)},Fe=function(e,n,t,r){if(!e)throw new Error("'"+t+"': Expected "+r+", but got "+JSON.stringify(n)+".")},Be=function(e,n){return Fe(ge(e),e,n,"true or false"),e},He=function(e,n){return Fe(N(e),e,n,"a function"),e},_e=function(e,n){return function(t,r){return Fe(t>=n,t,r,e+" greater than or equal to "+n),t}},Le=function(e){return function(n,t){return m(n)?Fe(!re(n),n,t,e):Fe(n.length>0,n,t,e),n}},Ve=function(){return function(e,n){Fe(function(e){for(var n=Object.create(null),t=0;t<e.length;t+=1){var r=e[t];if(r in n)return!1;n[r]=!0}return!0}(e),e,n,"array values to be unique")}},ze=/^[a-z0-9.-]{1,}$/i,Je=function(e,n){return Fe(ze.test(e),e,n,"a valid domain"),e},We=function(e,n){return Fe(ve(e),e,n,"an integer"),e},Qe=function(e,n){return Fe(pe(e),e,n,"a number"),e},Xe=function(e,n){return Fe(function(e){try{return null!==new RegExp(e)}catch(e){return!1}}(e),e,n,"a regular expression"),e},$e=function(e,n){if(null==e)throw new Error("'"+n+"' is a required option");return e},Ge=function(e,n){return Fe(me(e),e,n,"a string"),e},Ke=function(e){return e};Ke.default=function(e){return je(this,function(e){return function(n){return null==n?e:n}}(e))},Ke.required=function(){return je(this,$e)};var Ye=function(){return Ue(this,Je)},Ze=function(e){return Ue(this,_e("an integer",e))},en=function(e){return Ue(this,_e("a number",e))},nn=function(){return Ue(this,We,{minimum:Ze})},tn=function(){return Ue(this,Le("a non-empty string"))},rn=function(){return Ue(this,Le("a non-empty array"))},on=function(){return Ue(this,Le("a non-empty object"))},an=function(){return Ue(this,Xe)},cn=function(){return Ue(this,(e=[],function(n,t){return Fe(-1===e.indexOf(n),n,t,"a unique value across instances"),e.push(n),n}));var e},un=function(){return Ue(this,Ve())},sn=function(e,n){return je(this,function(e,n){return function(t,r){var o=D(e,(function(e){try{return e(t,r),!0}catch(e){return!1}}));return Fe(o,t,r,n),t}}(e,n))}.bind(Ke),dn=function(){return Ue(this,Ke)}.bind(Ke),fn=function(e){return Ue(this,function(e){return function(n,t){Fe(Array.isArray(n),n,t,"an array");var r=[],o=n.map((function(n,o){try{return e(n,t+"["+o+"]")}catch(e){return void r.push(e.message)}}));if(r.length)throw new Error(r.join("\n"));return o}}(e),{nonEmpty:rn,uniqueItems:un})}.bind(Ke),ln=function(){return Ue(this,Be)}.bind(Ke),gn=function(){return Ue(this,He)}.bind(Ke),pn=function(e){return Ue(this,function(e){return function(n,t){return Fe(n===e,n,t,""+e),n}}(e))}.bind(Ke);(function(){return Ue(this,Qe,{minimum:en,integer:nn,unique:cn})}).bind(Ke);var vn=function(e){return Ue(this,(n=e,function(e,t){Fe(m(e),e,t,"an object");var r=[],o={};if(Object.keys(e).forEach((function(i){var a=e[i],c=t?t+"."+i:i;try{var u=n(a,c);void 0!==u&&(o[i]=u)}catch(e){r.push(e.message)}})),r.length)throw new Error(r.join("\n"));return o}),{nonEmpty:on});var n}.bind(Ke),mn=function(e){return Ue(this,function(e){return function(n,t){Fe(m(n),n,t,"an object");var r=[],o={};if(Object.keys(e).forEach((function(i){var a=n[i],c=e[i],u=t?t+"."+i:i;try{var s=c(a,u);void 0!==s&&(o[i]=s)}catch(e){r.push(e.message)}})),Object.keys(n).forEach((function(e){Object.prototype.hasOwnProperty.call(o,e)||(o[e]=n[e])})),r.length)throw new Error(r.join("\n"));return o}}(e),{noUnknownFields:function(){return Ue(this,function(e){return function(n,t){var r=[];if(Object.keys(n).forEach((function(n){if(!e[n]){var o=t?t+"."+n:n;r.push("'"+o+"': Unknown field.")}})),r.length)throw new Error(r.join("\n"));return n}}(e))},nonEmpty:on})}.bind(Ke),hn=function(){return Ue(this,Ge,{regexp:an,domain:Ye,nonEmpty:tn,unique:cn})}.bind(Ke),yn=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return sn(n.map(pn),"one of these values: ["+JSON.stringify(n)+"]")},wn=vn(fn(mn({authenticatedState:yn("ambiguous","authenticated","loggedOut"),id:hn(),namespace:mn({code:hn()}).noUnknownFields(),primary:ln(),xid:hn()}).noUnknownFields()).required()),bn=mn({}),Cn=function(e){var n,t=e.console,r=e.locationSearch,o=e.createLogger,i=e.instanceName,a=e.createNamespacedStorage,c=e.getMonitors,u=Re(r),s=a("instance."+i+"."),d=s.session.getItem("debug"),f="true"===d,l=null===d,g=function(){return f},p=function(e,n){var t=n.fromConfig;t&&!l||(f=e),t||(s.session.setItem("debug",e.toString()),l=!1)};return void 0!==u.alloy_debug&&p((n=u.alloy_debug,me(n)&&"true"===n.toLowerCase()),{fromConfig:!1}),{setDebugEnabled:p,logger:o({getDebugEnabled:g,context:{instanceName:i},getMonitors:c,console:t}),createComponentLogger:function(e){return o({getDebugEnabled:g,context:{instanceName:i,componentName:e},getMonitors:c,console:t})}}},En=["onComponentsRegistered","onBeforeEvent","onBeforeFetch","onBeforeRequest","onResponse","onRequestFailure","onClick"],In=function(e){return En.reduce((function(n,t){var r;return n[t]=(r=function(e,n){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Promise.all(e.getLifecycleCallbacks(n).map((function(e){return new Promise((function(n){n(e.apply(void 0,r))}))})))}}(e,t),function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Promise.resolve().then((function(){return r.apply(void 0,n)}))}),n}),{})},Dn=function(e,n){return function(){var t;try{t=e.apply(void 0,arguments)}catch(e){throw Pe({error:e,message:n})}return t instanceof Promise&&(t=t.catch((function(e){throw Pe({error:e,message:n})}))),t}},Rn=function(){var e={},n={},t={};return{register:function(r,o){var i=o.commands,a=o.lifecycle;!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=le(Object.keys(n),Object.keys(t));if(r.length)throw new Error("[ComponentRegistry] Could not register "+e+" because it has existing command(s): "+r.join(","));Object.keys(t).forEach((function(r){var o=t[r];o.commandName=r,o.run=Dn(o.run,"["+e+"] An error occurred while executing the "+r+" command."),n[r]=o}))}(r,i),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(n).forEach((function(r){t[r]=t[r]||[],t[r].push(Dn(n[r],"["+e+"] An error occurred while executing the "+r+" lifecycle hook."))}))}(r,a),e[r]=o},getCommand:function(e){return n[e]},getCommandNames:function(){return Object.keys(n)},getLifecycleCallbacks:function(e){return t[e]||[]}}},Sn="in",On="pending",kn="general",Pn="declinedConsent",qn="default",xn="initial",Mn="new",An=function(e){var n=new Error(e);return n.code=Pn,n.message=e,n},Nn=function(e){var n=e.logger,t=[],r=function(){return Promise.resolve()},o=function(){return Promise.resolve()},i=function(){return Promise.reject(An("No consent preferences have been set."))},a=function(){return Promise.reject(An("The user declined consent."))},c=function(e){if(e)return Promise.reject(new Error("Consent is pending."));var n=I();return t.push(n),n.promise};return{in:function(e){e===qn?this.awaitConsent=r:(e===xn?n.info("Loaded user consent preferences. The user previously consented."):e===Mn&&this.awaitConsent!==o&&n.info("User consented."),function(){for(;t.length;)t.shift().resolve()}(),this.awaitConsent=o)},out:function(e){e===qn?(n.warn("User consent preferences not found. Default consent of out will be used."),this.awaitConsent=i):(e===xn?n.warn("Loaded user consent preferences. The user previously declined consent."):e===Mn&&this.awaitConsent!==a&&n.warn("User declined consent."),function(){for(;t.length;)t.shift().reject(An("The user declined consent."))}(),this.awaitConsent=a)},pending:function(e){e===qn&&n.info("User consent preferences not found. Default consent of pending will be used. Some commands may be delayed."),this.awaitConsent=c},awaitConsent:function(){return Promise.reject(new Error("Consent has not been initialized."))},withConsent:function(){return this.awaitConsent(!0)}}},Tn=function(){var e,n,t={},r=!1,o=!1,i=!0,a=function(e){if(o)throw new Error(e+" cannot be called after event is finalized.")},c={setUserXdm:function(n){a("setUserXdm"),e=n},setUserData:function(e){a("setUserData"),n=e},mergeXdm:function(e){a("mergeXdm"),e&&y(t,{xdm:e})},mergeMeta:function(e){a("mergeMeta"),e&&y(t,{meta:e})},mergeQuery:function(e){a("mergeQuery"),e&&y(t,{query:e})},documentMayUnload:function(){r=!0},finalize:function(r){if(!o&&(e&&c.mergeXdm(e),n&&(t.data=n),o=!0,r)){i=!1;var a={xdm:t.xdm||{},data:t.data||{}},u=r(a);i=!1!==u,t.xdm=a.xdm||{},t.data=a.data||{},re(t.xdm)&&delete t.xdm,re(t.data)&&delete t.data}},getDocumentMayUnload:function(){return r},isEmpty:function(){return re(t)&&(!e||re(e))&&(!n||re(n))},shouldSend:function(){return i},getViewName:function(){if(e&&e.web&&e.web.webPageDetails)return e.web.webPageDetails.viewName},toJSON:function(){if(!o)throw new Error("toJSON called before finalize");return t}};return c},jn="configure",Un="setDebug",Fn=function(e){var n=e.command,t=e.options,r=n.commandName,o=n.documentationUri,i=void 0===o?"https://adobe.ly/3sHgQHb":o,a=n.optionsValidator,c=t;if(a)try{c=a(t)}catch(e){throw new Error("Invalid "+r+" command options:\n\t - "+e+" For command documentation see: "+i)}return c},Bn=function(e){var n=e.eventManager,t=e.logger;return{commands:{sendEvent:{documentationUri:"https://adobe.ly/3GQ3Q7t",optionsValidator:function(e){return function(e){var n=e.options;return mn({type:hn(),xdm:mn({eventType:hn(),identityMap:wn}),data:mn({}),documentUnloading:ln(),renderDecisions:ln(),decisionScopes:fn(hn()).uniqueItems(),personalization:mn({decisionScopes:fn(hn()).uniqueItems(),surfaces:fn(hn()).uniqueItems()}),datasetId:hn(),mergeId:hn(),edgeConfigOverrides:bn}).required().noUnknownFields()(n)}({options:e})},run:function(e){var r=e.xdm,o=e.data,i=e.documentUnloading,a=void 0!==i&&i,c=e.type,u=e.mergeId,s=e.renderDecisions,d=void 0!==s&&s,f=e.decisionScopes,l=void 0===f?[]:f,g=e.personalization,p=void 0===g?{}:g,v=e.datasetId,m=e.edgeConfigOverrides,h=n.createEvent();a&&h.documentMayUnload(),h.setUserXdm(r),h.setUserData(o),c&&h.mergeXdm({eventType:c}),u&&h.mergeXdm({eventMergeId:u});var w={renderDecisions:d,decisionScopes:l,personalization:p};return m&&(w.edgeConfigOverrides=m),v&&(t.warn("The 'datasetId' option has been deprecated. Please use 'edgeConfigOverrides.experience_platform.datasets.event' instead."),w.edgeConfigOverrides=m||{},y(w.edgeConfigOverrides,{com_adobe_experience_platform:{datasets:{event:{datasetId:v}}}})),n.sendEvent(h,w)}},applyResponse:{documentationUri:"",optionsValidator:function(e){return function(e){var n=e.options;return mn({renderDecisions:ln(),responseHeaders:vn(hn().required()),responseBody:mn({handle:fn(mn({type:hn().required(),payload:dn().required()})).required()}).required()}).noUnknownFields()(n)}({options:e})},run:function(e){var t=e.renderDecisions,r=void 0!==t&&t,o=e.responseHeaders,i=void 0===o?{}:o,a=e.responseBody,c=void 0===a?{handle:[]}:a,u=n.createEvent();return n.applyResponse(u,{renderDecisions:r,responseHeaders:i,responseBody:c})}}}}};Bn.namespace="DataCollector",Bn.configValidators={};var Hn=function(e){var n=function(e){var n=e.eventManager,t=e.lifecycle,r=e.handleError;return function(e){var o=e.target,i=n.createEvent();return i.documentMayUnload(),t.onClick({event:i,clickedElement:o}).then((function(){return i.isEmpty()?Promise.resolve():n.sendEvent(i)})).then(ye).catch((function(e){r(e,"click collection")}))}}({eventManager:e.eventManager,lifecycle:e.lifecycle,handleError:e.handleError});document.addEventListener("click",n,!0)},_n={clickCollectionEnabled:ln().default(!0),downloadLinkQualifier:hn().regexp().default("\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$")},Ln=function(e,n,t,r){var o="other";return!function(e,n,t){var r=new RegExp(e);return!!t.download||r.test(n.toLowerCase())}(n.downloadLinkQualifier,t,r)?function(e,n){var t=e.location.hostname.toLowerCase();return!(n.toLowerCase().indexOf(t)>=0)}(e,t)&&(o="exit"):o="download",o},Vn=function(e){var n=e.config,t=e.eventManager,r=e.handleError,o=function(e,n){return function(t,r){if(n.clickCollectionEnabled){var o=function(e){for(var n,t=e;t;){if((n=t).href&&("A"===n.tagName||"AREA"===n.tagName)&&(!n.onclick||!n.protocol||n.protocol.toLowerCase().indexOf("javascript")<0))return t;t=t.parentNode}return null}(r);if(o){var i=function(e,n){var t=e.location,r=n.href?n.href:"",o=n.protocol,i=n.host;if(!function(e){return e&&/^[a-z0-9]+:\/\//i.test(e)}(r)){o||(o=t.protocol?t.protocol:""),o=o?o+"//":"",i||(i=t.host?t.host:"");var a="";if("/"!==r.substring(0,1)){var c=t.pathname.lastIndexOf("/");c=c<0?0:c,a=t.pathname.substring(0,c)}r=""+o+i+a+"/"+r}return r}(e,o);if(i){var a=Ln(e,n,i,o);t.documentMayUnload(),t.mergeXdm({eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:"Link Click",type:a,URL:i,linkClicks:{value:1}}}})}}}}}(window,n);return{lifecycle:{onComponentsRegistered:function(e){var o=e.lifecycle;Hn({config:n,eventManager:t,lifecycle:o,handleError:r})},onClick:function(e){var n=e.event,t=e.clickedElement;o(n,t)}}}};Vn.namespace="ActivityCollector",Vn.configValidators=_n;var zn,Jn,Wn,Qn=function(e,n){return"ID sync "+(n?"succeeded":"failed")+": "+e.spec.url},Xn={thirdPartyCookiesEnabled:ln().default(!0),idMigrationEnabled:ln().default(!0)},$n=mn({namespaces:fn(pn("ECID")).nonEmpty().uniqueItems().default(["ECID"]),edgeConfigOverrides:bn}).noUnknownFields().default({namespaces:["ECID"]}),Gn=mn({url:hn().required().nonEmpty(),edgeConfigOverrides:bn}).required().noUnknownFields(),Kn=function(e){var n=e.logger;return new Promise((function(e,t){if(m(window.adobe)&&m(window.adobe.optIn)){var r=window.adobe.optIn;n.info("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),r.fetchPermissions((function(){r.isApproved([r.Categories.ECID])?(n.info("Received legacy opt-in approval to let Visitor retrieve ECID from server."),e()):t(new Error("Legacy opt-in was declined."))}),!0)}else e()}))},Yn=function(e){var n=e.logger,t=e.orgId,r=e.awaitVisitorOptIn,o=function(e){var n=e.Visitor;return N(n)&&N(n.getInstance)&&n}(window);return function(){return o?r({logger:n}).then((function(){return n.info("Delaying request while using Visitor to retrieve ECID from server."),new Promise((function(e){o.getInstance(t,{}).getMarketingCloudVisitorID((function(t){n.info("Resuming previously delayed request that was waiting for ECID from Visitor."),e(t)}),!0)}))})).catch((function(e){e?n.info(e.message+", retrieving ECID from experience edge"):n.info("An error occurred while obtaining the ECID from Visitor.")})):Promise.resolve()}},Zn="ECID",et=function(e){e.mergeQuery({identity:{fetch:[Zn]}})},nt=(zn=function(o){var i,a;return(Ri(i={},n,/Edge\/([0-9\._]+)/),Ri(i,t,/Edg\/([0-9\.]+)/),Ri(i,e,/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/),Ri(i,"Firefox",/Firefox\/([0-9\.]+)(?:\s|$)/),Ri(i,"IE",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/),Ri(i,"Safari",/Version\/([0-9\._]+).*Safari/),a=i,function(e){for(var n=Object.keys(a),t=0;t<n.length;t+=1){var o=n[t];if(a[o].test(e))return o}return r})(o.navigator.userAgent)},Wn=new Map,function(){var e=Jn?Jn.apply(void 0,arguments):arguments.length<=0?void 0:arguments[0];if(Wn.has(e))return Wn.get(e);var n=zn.apply(void 0,arguments);return Wn.set(e,n),n}),tt=function(e,n){e.addIdentity(Zn,{id:n})},rt=function(e){var n=e.getPayloadsByType("identity:result"),t=D(n,(function(e){return e.namespace&&e.namespace.code===Zn}));return t?t.id:void 0},ot=function(e){return function(n,t){e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[n]=e.xdm.identityMap[n]||[],e.xdm.identityMap[n].push(t)}},it=function(e){var n=e.payload,t=e.getAction,r=e.getUseSendBeacon,o=Te(),i=!1,a=!1;return{getId:function(){return o},getPayload:function(){return n},getAction:function(){return t({isIdentityEstablished:a})},getUseSendBeacon:function(){return r({isIdentityEstablished:a})},getUseIdThirdPartyDomain:function(){return i},setUseIdThirdPartyDomain:function(){i=!0},setIsIdentityEstablished:function(){a=!0}}},at=function(e){var n=function(n){var t=n.isIdentityEstablished;return e.getDocumentMayUnload()&&t};return it({payload:e,getAction:function(e){var t=e.isIdentityEstablished;return n({isIdentityEstablished:t})?"collect":"interact"},getUseSendBeacon:n})},ct=function(e){var n=e.content,t=e.addIdentity,r=e.hasIdentity,o=w(n,"meta.configOverrides");return{mergeMeta:w(n,"meta"),mergeState:w(n,"meta.state"),mergeQuery:w(n,"query"),mergeConfigOverride:function(e){return o(be(e))},addIdentity:t,hasIdentity:r,toJSON:function(){return n}}},ut=function(e){return function(n){return void 0!==(e.xdm&&e.xdm.identityMap&&e.xdm.identityMap[n])}},st=function(){var e={},n=ct({content:e,addIdentity:ot(e),hasIdentity:ut(e)});return n.addEvent=function(n){e.events=e.events||[],e.events.push(n)},n.getDocumentMayUnload=function(){return(e.events||[]).some((function(e){return e.getDocumentMayUnload()}))},n},dt=function(e){return it({payload:e,getAction:function(){return"fetch"},getUseSendBeacon:function(){return!1}})},ft=function(){var e={},n=ct({content:e,addIdentity:ot(e),hasIdentity:ut(e)});return n.addEvent=function(n){e.events=e.events||[],e.events.push(n)},n},lt="clientId",gt=function(e){return it({payload:e,getAction:function(){return"identity/acquire"},getUseSendBeacon:function(){return!1}})},pt=function(e){var n={query:{identity:{fetch:e}}};return ct({content:n,addIdentity:ot(n),hasIdentity:ut(n)})},vt=/^([^?#]*)(\??[^#]*)(#?.*)$/,mt=function(e){var n=e.config,t=e.logger,r=e.consent,o=e.fireReferrerHideableImage,i=e.sendEdgeNetworkRequest,c=e.apexDomain,u=n.orgId,s=n.thirdPartyCookiesEnabled,d=n.edgeConfigOverrides,l=function(e){var n=e.config,t=e.getEcidFromVisitor,r=e.apexDomain,o=e.isPageSsl,i=e.cookieJar,a=n.idMigrationEnabled,c="AMCV_"+n.orgId,u=function(){var e=null,n=i.get("s_ecid")||i.get(c);if(n){var t=n.match(/(^|\|)MCMID\|(\d+)($|\|)/);t&&(e=t[2])}return e};return{getEcid:function(){if(a){var e=u();return e?Promise.resolve(e):t()}return Promise.resolve()},setEcid:function(e){if(a&&u()!==e){var n=o?{sameSite:"none",secure:!0}:{};i.set(c,"MCMID|"+e,Ii({domain:r,expires:390},n))}}}}({config:n,getEcidFromVisitor:Yn({logger:t,orgId:u,awaitVisitorOptIn:Kn}),apexDomain:c,cookieJar:C({logger:t,cookieJar:p}),isPageSsl:"https:"===window.location.protocol}),g=de({orgId:u}),v=function(e){var n=e.sendEdgeNetworkRequest,t=e.createIdentityRequestPayload,r=e.createIdentityRequest,o=e.globalConfigOverrides;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.namespaces,a=e.edgeConfigOverrides,c=t(i),u=r(c);return c.mergeConfigOverride(o),c.mergeConfigOverride(a),n({request:u})}}({sendEdgeNetworkRequest:i,createIdentityRequestPayload:pt,createIdentityRequest:gt,globalConfigOverrides:d}),m=function(e){var n=e.thirdPartyCookiesEnabled,t=e.areThirdPartyCookiesSupportedByDefault;return function(e){n&&t(nt(window))&&e.setUseIdThirdPartyDomain()}}({thirdPartyCookiesEnabled:s,areThirdPartyCookiesSupportedByDefault:a}),h=function(e){var n=e.getLegacyEcid,t=e.addEcidToPayload;return function(e){return e.hasIdentity(Zn)?Promise.resolve():n().then((function(n){n&&t(e,n)}))}}({getLegacyEcid:l.getEcid,addEcidToPayload:tt}),y=function(e){var n=e.locationSearch,t=e.dateProvider,r=e.orgId,o=e.logger;return function(e){if(!e.hasIdentity(Zn)){var i=Re(n).adobe_mc;if(void 0!==i){var a=i.split("|").reduce((function(e,n){var t=Oi(n.split("="),2),r=t[0],o=t[1];return e[r]=o,e}),{}),c=parseInt(a.TS,10),u=a.MCMID,s=decodeURIComponent(a.MCORGID);t().getTime()/1e3<=c+300&&s===r&&u?(o.info("Found valid ECID identity "+u+" from the adobe_mc query string parameter."),e.addIdentity(Zn,{id:u})):o.info("Detected invalid or expired adobe_mc query string parameter.")}}}}({locationSearch:window.document.location.search,dateProvider:function(){return new Date},orgId:u,logger:t}),w=function(e){var n=e.doesIdentityCookieExist,t=e.orgId;return function(e){var r=e.onResponse,o=e.onRequestFailure;return new Promise((function(e,i){r((function(){if(!n()){var r=new Error("An identity was not set properly. Please verify that the org ID "+t+" configured in Alloy matches the org ID specified in the edge configuration.");throw i(r),r}e()})),o((function(){n()?e():i(new Error("No identity was set on response."))}))}))}}({doesIdentityCookieExist:g,orgId:u}),b=function(e){var n,t=e.doesIdentityCookieExist,r=e.setDomainForInitialIdentityPayload,o=e.addLegacyEcidToPayload,i=e.awaitIdentityCookie,a=e.logger,c=function(e){return r(e),o(e.getPayload())};return function(e){var r=e.request,o=e.onResponse,u=e.onRequestFailure;if(t())return r.setIsIdentityEstablished(),Promise.resolve();if(n){a.info("Delaying request while retrieving ECID from server.");var s=n;return n=s.catch((function(){return i({onResponse:o,onRequestFailure:u})})),s.then((function(){a.info("Resuming previously delayed request."),r.setIsIdentityEstablished()})).catch((function(){return c(r)}))}return n=i({onResponse:o,onRequestFailure:u}),c(r)}}({doesIdentityCookieExist:g,setDomainForInitialIdentityPayload:m,addLegacyEcidToPayload:h,awaitIdentityCookie:w,logger:t}),E=function(e){var n=e.fireReferrerHideableImage,t=e.logger;return function(e){var r=e.filter((function(e){return"url"===e.type}));return r.length?Promise.all(r.map((function(e){return n(e.spec).then((function(){t.info(Qn(e,!0))})).catch((function(){t.error(Qn(e,!1))}))}))).then(ye):Promise.resolve()}}({fireReferrerHideableImage:o,logger:t}),I=function(e){var n=e.processIdSyncs;return function(e){return n(e.getPayloadsByType("identity:exchange"))}}({processIdSyncs:E}),D=function(e){var n=e.dateProvider,t=e.orgId;return function(e,r){var o=Math.round(n().getTime()/1e3),i=encodeURIComponent("TS="+o+"|MCMID="+e+"|MCORGID="+encodeURIComponent(t)),a=Oi(r.match(vt),4),c=a[1],u=a[2],s=a[3],d=function(e){return""===e?"?":"?"===e?"":"&"}(u);return""+c+u+d+"adobe_mc="+i+s}}({dateProvider:function(){return new Date},orgId:u,globalConfigOverrides:d});return function(e){var n,t=e.addEcidQueryToPayload,r=e.addQueryStringIdentityToPayload,o=e.ensureSingleIdentity,i=e.setLegacyEcid,a=e.handleResponseForIdSyncs,c=e.getEcidFromResponse,u=e.getIdentity,s=e.consent,d=e.appendIdentityToUrl,l=e.logger,g={};return{lifecycle:{onBeforeRequest:function(e){var n=e.request,i=e.onResponse,a=e.onRequestFailure;return t(n.getPayload()),r(n.getPayload()),o({request:n,onResponse:i,onRequestFailure:a})},onResponse:function(e){var t=e.response;return n||(n=c(t))&&i(n),g=f(g,t.getEdge()),a(t)}},commands:{getIdentity:{optionsValidator:$n,run:function(e){return s.awaitConsent().then((function(){return n?void 0:u(e)})).then((function(){return{identity:{ECID:n},edge:g}}))}},appendIdentityToUrl:{optionsValidator:Gn,run:function(e){return s.withConsent().then((function(){return n?void 0:u(e)})).then((function(){return{url:d(n,e.url)}})).catch((function(n){return l.warn("Unable to append identity to url. "+n.message),e}))}}}}}({addEcidQueryToPayload:et,addQueryStringIdentityToPayload:y,ensureSingleIdentity:b,setLegacyEcid:l.setEcid,handleResponseForIdSyncs:I,getEcidFromResponse:rt,getIdentity:v,consent:r,appendIdentityToUrl:D,logger:t,config:n})};mt.namespace="Identity",mt.configValidators=Xn;var ht=function(e,n){return"URL destination "+(n?"succeeded":"failed")+": "+e.spec.url},yt=function(e){var n=e.fireReferrerHideableImage,t=e.logger,r=e.cookieJar,o=e.isPageSsl?{sameSite:"none",secure:!0}:{};return function(e){return function(e){e.filter((function(e){return"cookie"===e.type})).forEach((function(e){var n=e.spec,t=n.name,i=n.value,a=n.domain,c=n.ttlDays;r.set(t,i||"",Ii({domain:a||"",expires:c||10},o))}))}(e),function(e){var r=e.filter((function(e){return"url"===e.type}));return Promise.all(r.map((function(e){return n(e.spec).then((function(){t.info(ht(e,!0))})).catch((function(){t.error(ht(e,!1))}))}))).then(ye)}(e)}},wt=function(e){var n=e.processDestinations;return function(e){var t,r,o=e.response;return(t={response:o},r=t.response.getPayloadsByType("activation:push"),n(r)).then((function(){return{destinations:{response:o}.response.getPayloadsByType("activation:pull")}}))}},bt=function(e){var n=e.logger,t=e.fireReferrerHideableImage,r=C({logger:n,cookieJar:p}),o=yt({fireReferrerHideableImage:t,logger:n,cookieJar:r,isPageSsl:"https:"===window.location.protocol});return{lifecycle:{onResponse:wt({processDestinations:o})},commands:{}}};bt.namespace="Audiences",bt.configValidators={};var Ct,Et="web",It="://",Dt=/^(\w+):\/\/([^/#]+)(\/[^#]*)?(#.*)?$/,Rt=/^(?:.*@)?(?:[a-z\d\u00a1-\uffff.-]+|\[[a-f\d:]+])(?::\d+)?$/,St=/^\/(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})*$/,Ot=/^#(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})+$/,kt=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=e.length;n>0&&-1!=="/".indexOf(e.charAt(n-1));)n-=1;return e.substring(0,n)||"/"},Pt=function(e){return""+e.surfaceType+It+e.authority+(e.path||"")+(e.fragment||"")},qt=function(e){var n=e(),t=n.host.toLowerCase(),r=n.pathname;return"web://"+t+kt(r)},xt=function(e,n,t){var r=function(e){return t.warn(e),null};if(!he(e))return r("Invalid surface: "+e);var i,a,c,u,s=function(e,n){return B(e,"#")?qt(n)+e:e}(e,n),d=(u=s.match(Dt))?{surfaceType:(c=u[1],he(c)?c.toLowerCase():""),authority:(a=u[2],he(a)?a.toLowerCase():""),path:(i=u[3],he(i)?kt(i):"/"),fragment:u[4]}:null;return null===d?r("Invalid surface: "+e):o([Et,"webapp"],d.surfaceType)?d.authority&&Rt.test(d.authority)?d.path&&!St.test(d.path)?r("Invalid path "+d.path+" in surface: "+e):d.fragment&&!Ot.test(d.fragment)?r("Invalid fragment "+d.fragment+" in surface: "+e):d:r("Invalid authority "+d.authority+" in surface: "+e):r("Unsupported surface type "+d.surfaceType+" in surface: "+e)},Mt="__view__",At="https://ns.adobe.com/personalization/default-content-item",Nt="https://ns.adobe.com/personalization/dom-action",Tt="https://ns.adobe.com/personalization/html-content-item",jt="https://ns.adobe.com/personalization/redirect-item",Ut=function(e){return e.filter((function(n,t){return e.indexOf(n)===t}))},Ft=function(e){var n=e.getPageLocation,t=e.renderDecisions,r=e.decisionScopes,i=e.personalization,a=e.event,c=e.viewCache,u=e.logger,s=a.getViewName();return{isRenderDecisions:function(){return t},getViewName:function(){return s},hasScopes:function(){return r.length>0||T(i.decisionScopes)},hasSurfaces:function(){return T(i.surfaces)},hasViewName:function(){return he(s)},createQueryDetails:function(){var e=ki(r);T(i.decisionScopes)&&e.push.apply(e,ki(i.decisionScopes));var t=function(){var e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return xt(t,e,n)})).filter((function(e){return!v(e)})).map(Pt)}(i.surfaces,n,u);this.isCacheInitialized()||(function(e){o(e,Mt)||e.push(Mt)}(e),function(e,n){var t=qt(n);o(e,t)||e.push(t)}(t,n));var a=[At,Tt,"https://ns.adobe.com/personalization/json-content-item",jt];return o(e,Mt)&&a.push(Nt),{schemas:a,decisionScopes:Ut(e),surfaces:Ut(t)}},isCacheInitialized:function(){return c.isInitialized()},shouldFetchData:function(){return this.hasScopes()||this.hasSurfaces()||!this.isCacheInitialized()},shouldUseCachedData:function(){return this.hasViewName()&&this.isCacheInitialized()}}},Bt="Rendering is disabled for authoring mode.",Ht={propositions:[]},_t=function(e){var n=e.getPageLocation,t=e.logger,r=e.fetchDataHandler,o=e.prefetchDataHandler,i=e.viewChangeHandler,a=e.onClickHandler,c=e.isAuthoringModeEnabled,u=e.mergeQuery,s=e.viewCache,d=e.showContainers,f=e.applyPropositions,l=e.setTargetMigration,g=e.decisionsMetaCache;return{lifecycle:{onBeforeRequest:function(e){var n=e.request;return l(n),Promise.resolve()},onBeforeEvent:function(e){var o=e.event,a=e.renderDecisions,f=e.decisionScopes,l=void 0===f?[]:f,p=e.personalization,v=void 0===p?{}:p,m=e.onResponse,h=void 0===m?ye:m,y=e.onRequestFailure,w=void 0===y?ye:y;if(h((function(){return{propositions:[]}})),w((function(){return d()})),c())return t.warn(Bt),void u(o,{enabled:!1});var b=g.flushToEvent(o),C=Ft({getPageLocation:n,renderDecisions:a,decisionScopes:l,personalization:v,event:o,viewCache:s,logger:t,isFetchCommand:!1});if(C.shouldFetchData()){var E=I();return s.storeViews(E.promise),w((function(){return E.reject()})),r({decisionsDeferred:E,personalizationDetails:C,event:o,onResponse:h}),b}if(C.shouldUseCachedData()){var D=i({personalizationDetails:C,event:o,onResponse:h,onRequestFailure:w});return b.then((function(){return D}))}return b},onBeforeFetch:function(e){var r=e.event,i=e.renderDecisions,a=e.personalization,f=void 0===a?{}:a,l=e.onResponse,p=void 0===l?ye:l,v=e.onRequestFailure,m=void 0===v?ye:v;if(p((function(){return{propositions:[]}})),m((function(){return d()})),c())return t.warn(Bt),void u(r,{enabled:!1});g.expectDecisionsMeta();var h=Ft({getPageLocation:n,renderDecisions:i,decisionScopes:[],personalization:f,event:r,viewCache:s,logger:t});if(h.shouldFetchData()){var y=I();s.storeViews(y.promise),m((function(){return y.reject()})),o({decisionsDeferred:y,personalizationDetails:h,event:r,onResponse:p})}},onClick:function(e){var n=e.event,t=e.clickedElement;a({event:n,clickedElement:t})}},commands:{applyPropositions:{optionsValidator:function(e){return function(e){var n=e.logger,t=e.options,r=mn({propositions:fn(mn(dn())).nonEmpty(),metadata:mn(dn())}).required();try{return r(t)}catch(e){return n.warn("Invalid options for applyPropositions. No propositions will be applied.",e),Ht}}({logger:t,options:e})},run:f}}}},Lt=function(e){return O("DIV",{},{innerHTML:e})},Vt=Ci((function(e,n){var t;t=l,e.exports=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var n=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var n,t=String(e),r=t.length,o=-1,i="",a=t.charCodeAt(0);++o<r;)0!=(n=t.charCodeAt(o))?i+=n>=1&&n<=31||127==n||0==o&&n>=48&&n<=57||1==o&&n>=48&&n<=57&&45==a?"\\"+n.toString(16)+" ":0==o&&1==r&&45==n||!(n>=128||45==n||95==n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122)?"\\"+t.charAt(o):t.charAt(o):i+="�";return i};return e.CSS||(e.CSS={}),e.CSS.escape=n,n}(t)})),zt=/:eq\((\d+)\)/g,Jt=function(e){return-1===e.indexOf(":eq(")},Wt=/(#|\.)(-?\w+)/g,Qt=function(e,n,t){return""+n+Vt(t)},Xt=function(e){for(var n=[],t=function(e){return e.split(zt).filter(he)}(function(e){return e.replace(Wt,Qt)}(e.trim())),r=t.length,o=0;o<r;){var i=t[o],a=t[o+1];a?n.push({sel:i,eq:Number(a)}):n.push({sel:i}),o+=2}return n},$t=function(e){var n=document;if(Jt(e))return z(e,n);for(var t=Xt(e),r=t.length,o=[],i=n,a=0;a<r;){var c=t[a],u=c.sel,s=c.eq,d=z(u,i),f=d.length;if(0===f)break;if(null!=s&&s>f-1)break;if(a<r-1)if(null==s)i=Oi(d,1)[0];else i=d[s];a===r-1&&(o=null==s?d:[d[s]]),a+=1}return o},Gt=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return n.getElementById(e)},Kt=function(e,n,t){e.setAttribute(n,t)},Yt=function(e,n){return e.getAttribute(n)},Zt=function(e){return e.parentNode},er=function(e,n){if(e){var t=Zt(e);t&&t.insertBefore(n,function(e){return e.nextElementSibling}(e))}},nr=function(e,n){if(e){var t=Zt(e);t&&t.insertBefore(n,e)}},tr=function(e){var n=e.childNodes;return n?j(n):[]},rr=function(e){return e.firstElementChild},or=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(void 0===Ct){var n=e.querySelector("[nonce]");Ct=n&&(n.nonce||n.getAttribute("nonce"))}return Ct},ir="alloy-prehiding",ar={},cr=function(e){var n=ar[e];n&&(ee(n),delete ar[e])},ur=function(e){if(e&&!Gt(ir)){var n=or(),t=Ii({id:ir},n&&{nonce:n}),r=O(x,t,{textContent:e});R(document.head,r)}},sr=function(){var e=Gt(ir);e&&ee(e)},dr=function(e,n){e.textContent=n},fr="src",lr=function(e){return O(q,{src:e})},gr=function(e){z(q,e).forEach((function(e){var n=Yt(e,fr);n&&lr(n)}))},pr=function(e){return function(e,n){return e.tagName===n}(e,x)&&!Yt(e,fr)},vr=function(e){var n=z(x,e),t=n.length,r=or();if(r)for(var o=0;o<t;o+=1){var i=n[o];pr(i)&&(i.nonce=r)}},mr=setTimeout;Ni.prototype.catch=function(e){return this.then(null,e)},Ni.prototype.then=function(e,n){var t=new this.constructor(Ai);return Ti(this,new Bi(e,n,t)),t},Ni.prototype.finally=function(e){var n=this.constructor;return this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){return n.reject(t)}))}))},Ni.all=function(e){return new Ni((function(n,t){if(!Mi(e))return t(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);var o=r.length;function i(e,a){try{if(a&&("object"===Di(a)||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(n){i(e,n)}),t)}r[e]=a,0==--o&&n(r)}catch(e){t(e)}}for(var a=0;a<r.length;a++)i(a,r[a])}))},Ni.resolve=function(e){return e&&"object"===Di(e)&&e.constructor===Ni?e:new Ni((function(n){n(e)}))},Ni.reject=function(e){return new Ni((function(n,t){t(e)}))},Ni.race=function(e){return new Ni((function(n,t){if(!Mi(e))return t(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)Ni.resolve(e[r]).then(n,t)}))},Ni._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){mr(e,0)},Ni._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var hr,yr=(hr=Object.freeze({__proto__:null,default:Ni}))&&hr.default||hr,wr="undefined"!=typeof window&&window.Promise||void 0!==l&&l.Promise||yr.default||yr,br=function(e){var n=document.createElement("script");n.src=e,n.async=!0;var t=function(e,n){return new wr((function(t,r){n.onload=function(){t(n)},n.onerror=function(){r(new Error("Failed to load script "+e))}}))}(e,n);return document.getElementsByTagName("head")[0].appendChild(n),t},Cr=function(e,n){return!!e&&e.tagName===n},Er=function(e){return Cr(e,M)&&!Yt(e,fr)},Ir=function(e){return Cr(e,M)&&Yt(e,fr)},Dr=function(e){for(var n=z(M,e),t=[],r=n.length,o=or(),i=Ii({},o&&{nonce:o}),a=0;a<r;a+=1){var c=n[a];if(Er(c)){var u=c.textContent;u&&t.push(O(M,i,{textContent:u}))}}return t},Rr=function(e){for(var n=z(M,e),t=[],r=n.length,o=0;o<r;o+=1){var i=n[o];if(Ir(i)){var a=Yt(i,fr);a&&t.push(a)}}return t},Sr=function(e,n){n.forEach((function(n){e.appendChild(n),e.removeChild(n)}))},Or=function(e){return Promise.all(e.map(br))},kr=function(e,n){var t=Lt(n);vr(t);var r=tr(t),o=Dr(t),i=Rr(t);return gr(t),r.forEach((function(n){R(e,n)})),Sr(e,o),Or(i)},Pr=function(e,n){!function(e){tr(e).forEach(ee)}(e),kr(e,n)},qr=function(e,n){var t=Lt(n);vr(t);var r=tr(t),o=Dr(t),i=Rr(t),a=r.length-1;for(gr(t);a>=0;){var c=r[a],u=rr(e);u?nr(u,c):R(e,c),a-=1}return Sr(e,o),Or(i)},xr=function(e,n){var t=Lt(n);vr(t);var r=tr(t),o=Dr(t),i=Rr(t);return gr(t),r.forEach((function(n){nr(e,n)})),Sr(e,o),Or(i)},Mr=function(e,n){xr(e,n),ee(e)},Ar=function(e,n){var t=Lt(n);vr(t);var r=tr(t),o=Dr(t),i=Rr(t);return gr(t),r.forEach((function(n){er(e,n)})),Sr(e,o),Or(i)},Nr=["priority"],Tr=function(e,n){var t=n.priority,r=Si(n,Nr);Object.keys(r).forEach((function(n){!function(e,n,t,r){var o;o=r?n+":"+t+" !"+r+";":n+":"+t+";",e.style.cssText+=";"+o}(e,n,r[n],t)}))},jr=function(e,n){Object.keys(n).forEach((function(t){Kt(e,t,n[t])}))},Ur=function(e,n){e.tagName===q&&(lr(n),function(e,n){e.removeAttribute(n)}(e,fr),Kt(e,fr,n))},Fr=function(e,n){var t=n.from,r=n.to,o=function(e){var n=e.children;return n?j(n):[]}(e),i=o[t],a=o[r];i&&a&&(t<r?er(a,i):nr(a,i))},Br=function(e){return function(n){var t=n.selector,r=n.prehidingSelector,o=n.content,i=n.meta;return function(e){if(!ar[e]){var n=or(),t=Ii({},n&&{nonce:n}),r=O(x,t,{textContent:e+" { visibility: hidden }"});R(document.head,r),ar[e]=r}}(r),Z(t,$t).then((function(n){return function(e,n,t){var r=e.map((function(e){return t(e,n)}));return Promise.all(r)}(n,o,e)})).then((function(){return cr(r),{meta:i}}),(function(e){return cr(r),{meta:i,error:e}}))}},Hr=function(e){return{setHtml:Br(Pr),customCode:Br(qr),setText:Br(dr),setAttribute:Br(jr),setImageSource:Br(Ur),setStyle:Br(Tr),move:Br(Tr),resize:Br(Tr),rearrange:Br(Fr),remove:Br(ee),insertAfter:Br(Ar),insertBefore:Br(xr),replaceHtml:Br(Mr),prependHtml:Br(qr),appendHtml:Br(kr),click:function(n){return function(e,n){return n({selector:e.selector,meta:e.meta}),Promise.resolve()}(n,e)},defaultContent:function(e){return Promise.resolve({meta:e.meta})}}},_r=function(e){var n,t=f({},e),r=t.content,o=t.selector;if(!me(n=r)||!n.trim())return t;var i=$t(o);return Cr(i[0],"HEAD")?(t.type="appendHtml",t.content=function(e){var n=Lt(e);return z("SCRIPT,LINK,STYLE",n).map((function(e){return e.outerHTML})).join("")}(r),t):t},Lr=function(e,n,t){if(e.enabled){var r=JSON.stringify(n),o=t.message,i=t.stack,a="Failed to execute action "+r+". "+o+" "+(i?"\n "+i:"");e.error(a)}},Vr=function(e,n,t){var r=e.map((function(e){var r=_r(e),o=r.type;return function(e,n,t,r){var o=n[t];if(!o){var i=new Error('DOM action "'+t+'" not found');throw Lr(e,r[0],i),i}return o.apply(void 0,ki(r))}(t,n,o,[r]).then((function(e){return function(e,n){if(e.enabled){var t=JSON.stringify(n);e.info("Action "+t+" executed.")}}(t,r),e})).catch((function(e){throw Lr(t,r,e),e}))}));return Promise.all(r)},zr="display",Jr="interact",Wr=function(e){return e},Qr=function(e){var n=e.modules,t=e.logger,r=e.executeActions;return function(e){var o=e.map((function(e){var o=function(e){var n={id:e.id,scope:e.scope,scopeDetails:e.scopeDetails};return e.items.map((function(e){return f({type:"defaultContent"},e.data,{meta:n})}))}(e);return r(o,n,t)}));return Promise.all(o).then((function(e){return function(e,n){var t=ie(n,Wr),r=[],o=new Set;return t.forEach((function(n){if(n)if(n.error)e.warn(n);else{var t=n.meta;o.has(t.id)||(o.add(t.id),r.push(t))}})),r}(t,e)})).catch((function(e){t.error(e)}))}},Xr=function(e){var n=e.prehidingStyle,t=e.responseHandler,r=e.hideContainers,o=e.mergeQuery;return function(e){var i=e.decisionsDeferred,a=e.personalizationDetails,c=e.event,u=e.onResponse;a.isRenderDecisions()&&r(n),o(c,a.createQueryDetails()),u((function(e){var n=e.response;return t({decisionsDeferred:i,personalizationDetails:a,response:n})}))}},$r=function(e,n){if(Jt(e))return function(e,n){return n.matches?n.matches(e):n.msMatchesSelector(e)}(e,n);for(var t=$t(e),r=!1,o=0;o<t.length;o+=1)if(t[o]===n){r=!0;break}return r},Gr=function(e,n,t){for(var r=document.documentElement,o=e;o&&o!==r;){if($r(n,o))return t(n);o=o.parentNode}return null},Kr=function(e,n,t){for(var r=[],o=0;o<n.length;o+=1){var i=Gr(e,n[o],t);i&&r.push.apply(r,ki(i))}return r},Yr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return-1!==e.location.href.indexOf("adobe_authoring_enabled")},Zr=function(e,n,t){e.mergeXdm({_experience:{decisioning:{propositions:n,propositionEventType:Ri({},t,1)}}})},eo=function(e,n){e.mergeQuery({personalization:Ii({},n)})},no=function(e){var n=e.decisions,t=e.renderAttempted;return n.map((function(e){return f({renderAttempted:t},e)}))},to=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,t={propositions:no({decisions:e,renderAttempted:n})};return n||(t.decisions=e),t},ro=function(e,n){var t=[],r=[];return e.forEach((function(e){o(n,e.schema)?t.push(e):r.push(e)})),[t,r]},oo=function(e,n){return{id:e.id,scope:e.scope,items:n,scopeDetails:e.scopeDetails}},io=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];var o=[],i=[];return e.forEach((function(e){var n=e.items,r=Oi(ro(void 0===n?[]:n,t),2),a=r[0],c=r[1];T(a)&&o.push(oo(e,a)),T(c)&&i.push(oo(e,c))})),{matchedDecisions:o,unmatchedDecisions:i}},ao=function(e){var n=[],t=[],r={};return T(e)&&e.forEach((function(e){var o,i;(i=e.scope)===Mt||function(e){return!!e&&0===e.indexOf("web://")&&-1===e.indexOf("#")}(i)?n.push(e):(o=e.scopeDetails).characteristics&&o.characteristics.scopeType&&"view"===o.characteristics.scopeType?function(e,n){e[n.scope]||(e[n.scope]=[]),e[n.scope].push(n)}(r,e):t.push(e)})),{pageWideScopeDecisions:n,nonPageWideScopeDecisions:t,viewScopeDecisions:r}},co=function(e){var n,t,r,i=io(e,jt),a=(n=i.unmatchedDecisions,t=n.filter((function(e){var n=e.items;return(void 0===n?[]:n).some((function(e){return"https://ns.adobe.com/personalization/measurement"===e.schema}))})),r=n.filter((function(e){return!o(t,e)})),{matchedDecisions:t,unmatchedDecisions:r}),c=io(a.unmatchedDecisions,Nt,At),u=ao(c.matchedDecisions),s=u.pageWideScopeDecisions,d=u.nonPageWideScopeDecisions,f=u.viewScopeDecisions;return{redirectDecisions:i.matchedDecisions,pageWideScopeDecisions:s,viewDecisions:f,nonAutoRenderableDecisions:[].concat(ki(a.matchedDecisions),ki(c.unmatchedDecisions),ki(d))}},uo=function(e){var n=e.autoRenderingHandler,t=e.nonRenderingHandler,r=e.groupDecisions,o=e.handleRedirectDecisions,i=e.showContainers;return function(e){var a=e.decisionsDeferred,c=e.personalizationDetails,u=e.response.getPayloadsByType("personalization:decisions"),s=c.getViewName();if(0===u.length)return i(),a.resolve({}),{decisions:[],propositions:[]};var d=r(u),f=d.redirectDecisions,l=d.pageWideScopeDecisions,g=d.viewDecisions,p=d.nonAutoRenderableDecisions;return c.isRenderDecisions()&&T(f)?(a.resolve({}),o(f)):(a.resolve(g),c.isRenderDecisions()?n({viewName:s,pageWideScopeDecisions:l,nonAutoRenderableDecisions:p}):t({viewName:s,redirectDecisions:f,pageWideScopeDecisions:l,nonAutoRenderableDecisions:p}))}},so=function(){var e={};return{storeClickMetrics:function(n){e[n.selector]||(e[n.selector]={}),e[n.selector][n.meta.id]={scope:n.meta.scope,scopeDetails:n.meta.scopeDetails}},getClickSelectors:function(){return Object.keys(e)},getClickMetasBySelector:function(n){return e[n]?function(e){return Object.keys(e).map((function(n){return{id:n,scope:e[n].scope,scopeDetails:e[n].scopeDetails}}))}(e[n]):{}}}},fo=function(e){var n=e.viewCache,t=e.executeDecisions,r=e.showContainers,o=e.collect;return function(e){var i=e.viewName,a=e.pageWideScopeDecisions,c=e.nonAutoRenderableDecisions;return Promise.resolve(a).then((function(e){return function(e){var n=e.viewCache,t=e.viewName,r=e.pageWideScopeDecisions;return t?n.getView(t).then((function(e){return{pageWideScopeDecisions:r,viewPropositions:e}})):{pageWideScopeDecisions:r,viewPropositions:[]}}({viewCache:n,viewName:i,pageWideScopeDecisions:e})})).then((function(e){var n=[t(e.pageWideScopeDecisions)];return i&&n.push(t(e.viewPropositions)),Promise.all(n).then((function(e){var n=e.reduce((function(e,n){return e.concat(n)}),[]);o({decisionsMeta:n,viewName:i})})),r(),[].concat(ki(e.pageWideScopeDecisions),ki(e.viewPropositions))})).then((function(e){return{decisions:ki(c),propositions:[].concat(ki(no({decisions:e,renderAttempted:!0})),ki(no({decisions:c,renderAttempted:!1})))}}))}},lo=function(e){var n=e.viewCache;return function(e){var t=e.viewName,r=e.redirectDecisions,o=e.pageWideScopeDecisions,i=e.nonAutoRenderableDecisions,a=[].concat(ki(r),ki(o),ki(i));return Promise.resolve(a).then((function(e){return function(e){var n=e.viewCache,t=e.viewName,r=e.propositions;return t?n.getView(t).then((function(e){return[].concat(ki(e),ki(r))})):r}({viewCache:n,viewName:t,propositions:e})})).then((function(e){return function(e){var n=e.propositions;return{decisions:n,propositions:no({decisions:n,renderAttempted:!1})}}({propositions:e})}))}},go=[Nt,Tt],po=function(e){var n=e.executeDecisions,t=function(e){return go.indexOf(e.schema)>-1},r=function(e){return!(e.scope===Mt&&e.renderAttempted)},o=function(e){var o=function(e){var n=e.propositions,o=e.metadata;return n.filter(r).map((function(e){var n,r,i;return T(e.items)?{id:e.id,scope:e.scope,scopeDetails:e.scopeDetails,items:(n={items:e.items,metadataForScope:o[e.scope]},r=n.items,i=n.metadataForScope,r.filter(t).map((function(e){return e.schema!==Tt?Ii({},e):m(i)?Ii(Ii({},e),{},{data:Ii(Ii({},e.data),{},{selector:i.selector,type:i.actionType})}):void 0})).filter((function(e){return e})))}:e})).filter((function(e){return T(e.items)}))}({propositions:e.propositions,metadata:e.metadata});return n(o).then((function(){return to(o,!0)}))};return function(e){var n=e.propositions,t=e.metadata,r=void 0===t?{}:t;return T(n)?o({propositions:n,metadata:r}):Promise.resolve(Ht)}},vo=function(e){var n,t,r=e.config,o=e.logger,i=e.eventManager,a=r.targetMigrationEnabled,c=r.prehidingStyle,u=function(e){var n=e.eventManager,t=e.mergeDecisionsMeta;return function(e){var r=e.decisionsMeta,o=void 0===r?[]:r,i=e.documentMayUnload,a=void 0!==i&&i,c=e.viewName,u=n.createEvent(),s={eventType:"decisioning.propositionDisplay"};if(c&&(s.web={webPageDetails:{viewName:c}}),T(o)&&t(u,o,zr),u.mergeXdm(s),a&&u.documentMayUnload(),c||T(o))return n.sendEvent(u)}}({eventManager:i,mergeDecisionsMeta:Zr}),s=function(e){var n,t,r=e.mergeDecisionsMeta,o=[];return{hold:function(e){var r=e.decisionsMeta,i=e.viewName;o.push({decisionsMeta:r,viewName:i}),t=null,n()},flushToEvent:function(e){return t&&(t=t.then((function(){o.forEach((function(n){var t=n.decisionsMeta,o=n.viewName;T(t)&&r(e,t,zr),o&&e.mergeXdm({web:{webPageDetails:{viewName:o}}})})),o=[]}))),t},expectDecisionsMeta:function(){if(!t){var e=I();n=e.resolve,t=e.promise}}}}({mergeDecisionsMeta:Zr}),d=function(e){var n=e.decisionsMetaCache;return function(e){var t=e.decisionsMeta,r=void 0===t?[]:t,o=e.viewName;return n.hold({decisionsMeta:r,viewName:o}),Promise.resolve()}}({decisionsMetaCache:s}),l=so(),g=l.getClickMetasBySelector,p=l.getClickSelectors,v=l.storeClickMetrics,m=function(e){var n=e.window;return function(){return n.location}}({window:window}),h=(t=I(),{storeViews:function(e){e.then((function(e){void 0===n&&(n={}),f(n,e),t.resolve()})).catch((function(){void 0===n&&(n={}),t.resolve()}))},getView:function(e){return t.promise.then((function(){return n[e]||[]}))},isInitialized:function(){return!(void 0===n)}}),y=Hr(v),w=Qr({modules:y,logger:o,executeActions:Vr}),b=function(e){var n=e.collect,t=e.window,r=e.logger,o=e.showContainers;return function(e){var i=function(e){var n=e[0],t=n.items,r=n.id,o=n.scope,i=n.scopeDetails;return{content:t[0].data.content,decisions:[{id:r,scope:o,scopeDetails:i}]}}(e),a=i.content,c=i.decisions;return n({decisionsMeta:c,documentMayUnload:!0}).then((function(){t.location.replace(a)})).catch((function(){o(),r.warn("An error occurred while executing the redirect offer.")}))}}({collect:u,window:window,logger:o,showContainers:sr}),C=fo({viewCache:h,executeDecisions:w,showContainers:sr,collect:u}),E=fo({viewCache:h,executeDecisions:w,showContainers:sr,collect:d}),D=po({executeDecisions:w}),R=lo({viewCache:h}),S=uo({autoRenderingHandler:C,nonRenderingHandler:R,groupDecisions:co,handleRedirectDecisions:b,showContainers:sr}),O=uo({autoRenderingHandler:E,nonRenderingHandler:R,groupDecisions:co,handleRedirectDecisions:b,showContainers:sr}),k=Xr({prehidingStyle:c,responseHandler:S,hideContainers:ur,mergeQuery:eo}),P=Xr({prehidingStyle:c,responseHandler:O,hideContainers:ur,mergeQuery:eo}),q=function(e){var n=e.mergeDecisionsMeta,t=e.collectClicks,r=e.getClickSelectors,o=e.getClickMetasBySelector;return function(e){var i=e.event,a=e.clickedElement,c=r();if(T(c)){var u=t(a,c,o);if(T(u)){var s={eventType:"decisioning.propositionInteract"},d=u[0].scope;d!==Mt&&(s.web={webPageDetails:{viewName:d}}),i.mergeXdm(s),n(i,u,Jr)}}}}({mergeDecisionsMeta:Zr,collectClicks:Kr,getClickSelectors:p,getClickMetasBySelector:g}),x=function(e){var n=e.mergeDecisionsMeta,t=e.collect,r=e.executeDecisions,o=e.viewCache;return function(e){var i=e.personalizationDetails,a=e.event,c=e.onResponse,u=i.getViewName();return o.getView(u).then((function(e){return i.isRenderDecisions()?r(e).then((function(r){if(T(r))return n(a,r,zr),void c((function(){return to(e,!0)}));c((function(){return t({decisionsMeta:[],viewName:u}),to(e,!0)}))})):(c((function(){return to(e,!1)})),{})}))}}({mergeDecisionsMeta:Zr,collect:u,executeDecisions:w,viewCache:h}),M=function(e){return e.targetMigrationEnabled?function(e){e.getPayload().mergeMeta({target:{migration:!0}})}:ye}({targetMigrationEnabled:a});return _t({getPageLocation:m,logger:o,fetchDataHandler:k,prefetchDataHandler:P,viewChangeHandler:x,onClickHandler:q,isAuthoringModeEnabled:Yr,mergeQuery:eo,viewCache:h,showContainers:sr,applyPropositions:D,setTargetMigration:M,decisionsMetaCache:s})};vo.namespace="Personalization",vo.configValidators={prehidingStyle:hn().nonEmpty(),targetMigrationEnabled:ln().default(!1)};var mo,ho="2.14.0-alpha.10",yo=["architecture","bitness","model","platformVersion","wow64"],wo=function(e){return function(n){var t={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};y(n,{web:t})}}(window),bo=function(e){return function(n){var t=e.screen,r=t.width,o={screenHeight:t.height,screenWidth:r},i=function(e){var n=e.screen.orientation;if(null==n||null==n.type)return null;var t=n.type.split("-");return 0===t.length||"portrait"!==t[0]&&"landscape"!==t[0]?null:t[0]}(e)||function(e){return e.matchMedia("(orientation: portrait)").matches?"portrait":e.matchMedia("(orientation: landscape)").matches?"landscape":null}(e);i&&(o.screenOrientation=i),y(n,{device:o})}}(window),Co=function(e){return function(n){var t=e.document.documentElement,r=(t=void 0===t?{}:t).clientWidth,o=t.clientHeight,i={type:"browser"};pe(r)&&r>=0&&pe(o)&&o>=0&&(i.browserDetails={viewportWidth:Math.round(r),viewportHeight:Math.round(o)}),y(n,{environment:i})}}(window),Eo=(mo=function(){return new Date},function(e){var n=mo(),t={},r=qe(n.getTimezoneOffset());void 0!==r&&(t.localTimezoneOffset=r),(void 0===r||Math.abs(r)<6e3)&&(t.localTime=function(e){var n=e.getFullYear(),t=we(e.getMonth()+1,2,"0"),r=we(e.getDate(),2,"0"),o=we(e.getHours(),2,"0"),i=we(e.getMinutes(),2,"0"),a=we(e.getSeconds(),2,"0"),c=we(e.getMilliseconds(),3,"0"),u=qe(e.getTimezoneOffset(),0);return n+"-"+t+"-"+r+"T"+o+":"+i+":"+a+"."+c+(u>0?"-":"+")+we(Math.floor(Math.abs(u)/60),2,"0")+":"+we(Math.abs(u)%60,2,"0")}(n)),y(e,{placeContext:t})}),Io=function(e){return function(n){var t=e().toISOString();y(n,{timestamp:t})}}((function(){return new Date})),Do={web:wo,device:bo,environment:Co,placeContext:Eo},Ro={highEntropyUserAgentHints:function(e){return function(e){return void 0!==e.userAgentData}(e)?function(n,t){try{return e.userAgentData.getHighEntropyValues(yo).then((function(e){var t={};yo.forEach((function(n){Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})),y(n,{environment:{browserDetails:{userAgentClientHints:t}}})}))}catch(e){return t.warn("Unable to collect user-agent client hints. "+e.message),ye}}:ye}(navigator)},So=Ii(Ii({},Do),Ro),Oo=[Io,function(e){y(e,{implementationDetails:{name:"https://ns.adobe.com/experience/alloy",version:ho,environment:"browser"}})}],ko=function(e){return function(e,n,t,r){var o=e.context,i=ie(o,(function(e,r){return t[e]?[t[e]]:(n.warn("Invalid context["+r+"]: '"+e+"' is not available."),[])})).concat(r),a=function(e){var t=e.event,r={};return Promise.all(i.map((function(e){return Promise.resolve(e(r,n))}))).then((function(){return t.mergeXdm(r)}))};return{namespace:"Context",lifecycle:{onBeforeEvent:a,onBeforeFetch:a}}}(e.config,e.logger,So,Oo)};ko.namespace="Context",ko.configValidators={context:fn(hn()).default(Object.keys(Do))};var Po=function e(n){return Array.isArray(n)?n.map((function(n){return e(n)})):"object"===Di(n)&&null!==n?Object.keys(n).sort().reduce((function(t,r){return t[r]=e(n[r]),t}),{}):n},qo=function(e){return E(JSON.stringify(Po(e)))},xo=["standard","version"],Mo=function(e){return e.standard+"."+e.version},Ao=function(){var e={},n=ct({content:e,addIdentity:function(n,t){e.identityMap=e.identityMap||{},e.identityMap[n]=e.identityMap[n]||[],e.identityMap[n].push(t)},hasIdentity:function(n){return void 0!==(e.identityMap&&e.identityMap[n])}});return n.setConsent=function(n){e.consent=n},n},No=function(e){return it({payload:e,getAction:function(){return"privacy/set-consent"},getUseSendBeacon:function(){return!1}})},To=function(e){return e.split(";").reduce((function(e,n){var t=Oi(n.split("="),2),r=t[0],o=t[1];return e[r]=o,e}),{})},jo=mn({consent:fn(dn()).required().nonEmpty(),identityMap:wn,edgeConfigOverrides:bn}).noUnknownFields().required(),Uo=function(e){var n,t,r=e.config,o=e.consent,i=e.sendEdgeNetworkRequest,a=e.createNamespacedStorage,c=r.orgId,u=r.defaultConsent,s=function(e){var n=e.parseConsentCookie,t=e.orgId,r=e.cookieJar,o=se(t,"consent");return{read:function(){var e=r.get(o);return e?n(e):{}},clear:function(){r.remove(o)}}}({parseConsentCookie:To,orgId:c,cookieJar:p}),d=(n=0,t=Promise.resolve(),{addTask:function(e){n+=1;var r=function(){return e().finally((function(){n-=1}))};return t=t.then(r,r)},get length(){return n}}),f=function(e){var n=e.createConsentRequestPayload,t=e.createConsentRequest,r=e.sendEdgeNetworkRequest,o=e.edgeConfigOverrides;return function(e){var i=e.consentOptions,a=e.identityMap,c=e.edgeConfigOverrides,u=n();u.setConsent(i),u.mergeConfigOverride(o),u.mergeConfigOverride(c),m(a)&&Object.keys(a).forEach((function(e){a[e].forEach((function(n){u.addIdentity(e,n)}))}));var s=t(u);return r({request:s}).then((function(){}))}}({createConsentRequestPayload:Ao,createConsentRequest:No,sendEdgeNetworkRequest:i,edgeConfigOverrides:r.edgeConfigOverrides}),l=function(e){var n=e.storage;return{clear:function(){n.clear()},lookup:function(e){var t={},r=function(e){var n=Mo(e);e.standard,e.version;var r=Si(e,xo);return t[n]||(t[n]=qo(r).toString()),t[n]};return{isNew:function(){return e.some((function(e){var t=Mo(e),o=n.getItem(t);return null===o||o!==r(e)}))},save:function(){e.forEach((function(e){var t=Mo(e);n.setItem(t,r(e))}))}}}}}({storage:a(ue(c)+".consentHashes.").persistent}),g=de({orgId:c});return function(e){var n=e.storedConsent,t=e.taskQueue,r=e.defaultConsent,o=e.consent,i=e.sendSetConsentRequest,a=e.validateSetConsentOptions,c=e.consentHashStore,u=e.doesIdentityCookieExist,s=Ri({},kn,r),d=n.read(),f=u(),l=void 0!==d.general;f&&l||c.clear(),f||(n.clear(),d={}),o.initializeConsent(s,d);var g=function(){if(0===t.length){var e=n.read();void 0!==e.general&&o.setConsent(e)}};return{commands:{setConsent:{optionsValidator:a,run:function(e){var n=e.consent,r=e.identityMap,a=e.edgeConfigOverrides;o.suspend();var u=c.lookup(n);return t.addTask((function(){return u.isNew()?i({consentOptions:n,identityMap:r,edgeConfigOverrides:a}):Promise.resolve()})).then((function(){return u.save()})).finally(g)}}},lifecycle:{onResponse:g,onRequestFailure:g}}}({storedConsent:s,taskQueue:d,defaultConsent:u,consent:o,sendSetConsentRequest:f,validateSetConsentOptions:jo,consentHashStore:l,doesIdentityCookieExist:g})};Uo.namespace="Privacy";var Fo=function(){return{eventMergeId:Te()}},Bo=function(){return{commands:{createEventMergeId:{run:{createEventMergeId:Fo}.createEventMergeId}}}};Bo.namespace="EventMerge",Bo.configValidators={};var Ho=function(e){var n=function(e){var n=e.config,t=e.componentRegistry,r=[].concat(ki(t.getCommandNames()),[jn,Un]).sort(),o=Ii({},n);return Object.keys(n).forEach((function(e){var t=n[e];"function"==typeof t&&(o[e]=t.toString())})),{version:ho,configs:o,commands:r}}({config:e.config,componentRegistry:e.componentRegistry});return{commands:{getLibraryInfo:{run:function(){return{libraryInfo:n}}}}}};Ho.namespace="LibraryInfo";var _o=function(e){return{inferences:e.response.getPayloadsByType("rtml:inferences")}},Lo=function(){return{lifecycle:{onResponse:_o},commands:{}}};Lo.namespace="MachineLearning",Lo.configValidators={};var Vo=mn({xdm:mn({identityMap:wn}),data:mn({}),renderDecisions:ln(),personalization:mn({decisionScopes:fn(hn()).uniqueItems(),surfaces:fn(hn()).uniqueItems()}),edgeConfigOverrides:bn}).required().noUnknownFields(),zo=function(e){var n=e.eventManager;return{commands:{fetch:{optionsValidator:Vo,run:function(e){var t=e.xdm,r=e.data,o=e.renderDecisions,i=void 0!==o&&o,a=e.personalization,c=void 0===a?[]:a,u=e.edgeConfigOverrides,s=n.createEvent();return s.setUserXdm(t),s.setUserData(r),n.fetch(s,{renderDecisions:i,personalization:c,edgeConfigOverrides:u})}}}}};zo.namespace="Fetch",zo.configValidators={};var Jo,Wo,Qo=[Bn,Vn,mt,bt,vo,ko,Uo,Bo,Ho,Lo,zo],Xo=function(e){var n=e.options,t=e.componentCreators,r=e.coreConfigValidators,o=e.createConfig,i=e.logger,a=e.setDebugEnabled,c=function(e,n){var t={};return f(t,e),n.forEach((function(e){var n=e.configValidators;f(t,n)})),t}(r,t),u=o(function(e,n){try{return mn(e).noUnknownFields().required()(n)}catch(e){throw new Error("Resolve these configuration problems:\n\t - "+e.message.split("\n").join("\n\t - ")+"\nFor configuration documentation see: https://adobe.ly/3sHh553")}}(c,n));return a(u.debugEnabled,{fromConfig:!0}),i.logOnInstanceConfigured({config:u}),u},$o=function(e){return f({},e)},Go=function(e){var n=e.errorPrefix,t=e.logger;return function(e,r){var o=Oe(e);if(o.code===Pn)return t.warn("The "+r+" could not fully complete. "+o.message),{};throw ke({error:o,message:n+" "+o.message}),o}},Ko=function(e){var n=e.getDebugEnabled,t=e.console,r=e.getMonitors,o=e.context,i="["+o.instanceName+"]";o.componentName&&(i+=" ["+o.componentName+"]");var a=function(e,n){var t=r();if(t.length>0){var i=f({},o,n);t.forEach((function(n){n[e]&&n[e](i)}))}},c=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),c=1;c<r;c++)o[c-1]=arguments[c];a("onBeforeLog",{level:e,arguments:o}),n()&&t[e].apply(t,[i].concat(o))};return{get enabled(){return r().length>0||n()},logOnInstanceCreated:function(e){a("onInstanceCreated",e),c("info","Instance initialized.")},logOnInstanceConfigured:function(e){a("onInstanceConfigured",e),c("info","Instance configured. Computed configuration:",e.config)},logOnBeforeCommand:function(e){a("onBeforeCommand",e),c("info","Executing "+e.commandName+" command. Options:",e.options)},logOnCommandResolved:function(e){a("onCommandResolved",e),c("info",e.commandName+" command resolved. Result:",e.result)},logOnCommandRejected:function(e){a("onCommandRejected",e),c("error",e.commandName+" command was rejected. Error:",e.error)},logOnBeforeNetworkRequest:function(e){a("onBeforeNetworkRequest",e),c("info","Request "+e.requestId+": Sending request.",e.payload)},logOnNetworkResponse:function(e){a("onNetworkResponse",e);var n=e.parsedBody||e.body?"response body:":"no response body.";c("info","Request "+e.requestId+": Received response with status code "+e.statusCode+" and "+n,e.parsedBody||e.body)},logOnNetworkError:function(e){a("onNetworkError",e),c("error","Request "+e.requestId+": Network request failed.",e.error)},info:c.bind(null,"info"),warn:c.bind(null,"warn"),error:c.bind(null,"error")}},Yo="Event was canceled because the onBeforeEventSend callback returned false.",Zo=function(e){var n=e.orgId,t=e.targetMigrationEnabled;return function(e){return function(e,n){return 0===n.indexOf("kndctr_"+ue(e)+"_")}(n,e)||"at_qa_mode"===e||t&&"mbox"===e}},ei=function(e){var n=e.shift()||[],t=e.shift()||[],r=e;return f.apply(void 0,[{}].concat(ki(n),ki(t),ki(r)))},ni=function(e){return function(n){var t=function(){throw n};return e.call({error:n}).then(t,t)}},ti="The server responded with a",ri=function(e){var n=e.orgId,t=e.cookieJar,r=se(n,"cluster");return function(){return t.get(r)||function(){var e=t.get("mboxEdgeCluster");if(e)return"t"+e}()}},oi=[429,503,502,504],ii=function(e){var n=e.response;return e.retriesAttempted<3&&o(oi,n.statusCode)},ai=function(e){var n=e.response,t=e.retriesAttempted,r=function(e){var n,t=e.getHeader("Retry-After");if(t){var r=parseInt(t,10);n=ve(r)?1e3*r:Math.max(0,new Date(t).getTime()-(new Date).getTime())}return n}(n);return void 0===r&&(r=function(e){var n=1e3+1e3*e,t=.3*n,r=n-t,o=n+t;return Math.round(r+Math.random()*(o-r))}(t)),r},ci=(Jo=window,function(e){var n=ae+e;return{session:fe(Jo,"sessionStorage",n),persistent:fe(Jo,"localStorage",n)}}),ui=window,si=ui.console,di=ui.fetch,fi=ui.navigator,li=ui.XMLHttpRequest,gi=function(){return window.__alloyMonitors||[]},pi={debugEnabled:ln().default(!1),defaultConsent:yn(Sn,"out",On).default(Sn),edgeConfigId:hn().unique().required(),edgeDomain:hn().domain().default("edge.adobedc.net"),edgeBasePath:hn().nonEmpty().default("ee"),orgId:hn().unique().required(),onBeforeEventSend:gn().default(ye),edgeConfigOverrides:bn},vi=function(e,n){for(var t,r,o="",i=e.location.hostname.toLowerCase().split("."),a=1;a<i.length&&!n.get(ce);)o=(t=i,r=a+=1,t.slice(-r)).join("."),n.set(ce,ce,{domain:o});return n.remove(ce,{domain:o}),o}(window,p),mi=N(di)?function(e){var n=e.fetch;return function(e,t){return n(e,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},referrer:"client",body:t}).then((function(e){return e.text().then((function(n){return{statusCode:e.status,getHeader:function(n){return e.headers.get(n)},body:n}}))}))}}({fetch:di}):function(e){var n=e.XMLHttpRequest;return function(e,t){return new Promise((function(r,o){var i=new n;i.onreadystatechange=function(){4===i.readyState&&(0===i.status?o(new Error("Request aborted.")):r({statusCode:i.status,getHeader:function(e){return i.getResponseHeader(e)},body:i.responseText}))},i.onloadstart=function(){i.responseType="text"},i.open("POST",e,!0),i.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),i.withCredentials=!0,i.onerror=o,i.onabort=o,i.send(t)}))}}({XMLHttpRequest:li}),hi=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.appendNode,r=void 0===t?R:t,o=n.awaitSelector,i=void 0===o?Z:o,a=n.createNode,c=void 0===a?O:a,u=n.fireImage,s=void 0===u?A:u,d=s,f=function(){return i(k).then((function(n){var t=Oi(n,1)[0];return e||(e=c(P,ne,te),r(t,e))}))},l=function(e){var n=e.src;return f().then((function(e){var t=e.contentWindow.document;return s({src:n,currentDocument:t})}))};return function(e){var n=e.hideReferrer,t=e.url;return n?l({src:t}):d({src:t})}}(),yi=function(e){var n=e.window,t=(0,e.createNamespacedStorage)("validation.");return function(){var e=Re(n.location.search).adb_validation_sessionid;if(!e)return"";var r=function(e){var n=e.persistent.getItem(lt);return n||(n=Te(),e.persistent.setItem(lt,n)),n}(t);return"&"+Se({adobeAepValidationToken:e+"|"+r})}}({window:window,createNamespacedStorage:ci}),wi=function(e){var n=e.instanceName,t=e.logController,r=t.setDebugEnabled,o=t.logger,i=t.createComponentLogger,a=Rn(),c=In(a),u=C({logger:o,cookieJar:p}),s=Go({errorPrefix:"["+n+"]",logger:o}),d=function(e){var n,t=e.logger,r=e.configureCommand,o=e.setDebugCommand,i=e.handleError,a=e.validateCommandOptions,c=function(e,i){var c;if(e===jn){if(n)throw new Error("The library has already been configured and may only be configured once.");c=function(){return(n=r(i)).then((function(){}))}}else{if(!n)throw new Error("The library must be configured first. Please do so by executing the configure command.");c=e===Un?function(){return o(i)}:function(){return n.then((function(n){var t=n.getCommand(e);if(!t||!N(t.run)){var r=[jn,Un].concat(n.getCommandNames()).join(", ");throw new Error("The "+e+" command does not exist. List of available commands: "+r+".")}var o=a({command:t,options:i});return t.run(o)}),(function(){return t.warn("An error during configuration is preventing the "+e+" command from executing."),new Promise((function(){}))}))}}return c};return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(r){var o=c(e,n);t.logOnBeforeCommand({commandName:e,options:n}),r(o())})).catch((function(n){return i(n,e+" command")})).catch((function(r){throw t.logOnCommandRejected({commandName:e,options:n,error:r}),r})).then((function(r){var o=m(r)?r:{};return t.logOnCommandResolved({commandName:e,options:n,result:o}),o}))}}({logger:o,configureCommand:function(e){var t=Xo({options:e,componentCreators:Qo,coreConfigValidators:pi,createConfig:$o,logger:o,setDebugEnabled:r}),s=t.orgId,d=t.targetMigrationEnabled,f=Zo({orgId:s,targetMigrationEnabled:d}),l=function(e){var n=e.cookieJar,t=e.shouldTransferCookie,r=e.apexDomain,o=e.dateProvider;return{cookiesToPayload:function(e,o){var i,a=(i=r,o.substr(-i.length)===i),c={domain:r,cookiesEnabled:!0};if(!a){var u=n.get(),s=Object.keys(u).filter(t).map((function(e){return{key:e,value:u[e]}}));s.length&&(c.entries=s)}e.mergeState(c)},responseToCookies:function(e){e.getPayloadsByType("state:store").forEach((function(e){var t={domain:r},i=e.attrs&&e.attrs.SameSite&&e.attrs.SameSite.toLowerCase();void 0!==e.maxAge&&(t.expires=new Date(o().getTime()+1e3*e.maxAge)),void 0!==i&&(t.sameSite=i),"none"===i&&(t.secure=!0),n.set(e.key,e.value,t)}))}}}({cookieJar:u,shouldTransferCookie:f,apexDomain:vi,dateProvider:function(){return new Date}}),g=N(fi.sendBeacon)?function(e){var n=e.sendBeacon,t=e.sendFetchRequest,r=e.logger;return function(e,o){var i=new Blob([o],{type:"text/plain; charset=UTF-8"});return n(e,i)?Promise.resolve({statusCode:204,getHeader:function(){return null},body:""}):(r.info("Unable to use `sendBeacon`; falling back to `fetch`."),t(e,o))}}({sendBeacon:fi.sendBeacon.bind(fi),sendFetchRequest:mi,logger:o}):mi,v=function(e){var n=e.logger,t=e.sendFetchRequest,r=e.sendBeaconRequest,o=e.isRequestRetryable,i=e.getRequestRetryDelay;return function(e){var a=e.requestId,c=e.url,u=e.payload,s=e.useSendBeacon,d=JSON.stringify(u),f=JSON.parse(d);return n.logOnBeforeNetworkRequest({url:c,requestId:a,payload:f}),function e(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(s?r:t)(c,d).then((function(t){var r;if(o({response:t,retriesAttempted:u})){var s=i({response:t,retriesAttempted:u});return new Promise((function(n){setTimeout((function(){n(e(u+1))}),s)}))}try{r=JSON.parse(t.body)}catch(e){}return n.logOnNetworkResponse(Ii(Ii({requestId:a,url:c,payload:f},t),{},{parsedBody:r,retriesAttempted:u})),{statusCode:t.statusCode,body:t.body,parsedBody:r,getHeader:t.getHeader}}))}().catch((function(e){throw n.logOnNetworkError({requestId:a,url:c,payload:f,error:e}),Pe({error:e,message:"Network request failed."})}))}}({logger:o,sendFetchRequest:mi,sendBeaconRequest:g,isRequestRetryable:ii,getRequestRetryDelay:ai}),m=function(e){var n=e.logger;return function(e){var t=e.statusCode,r=e.body,o=e.parsedBody;if(t<200||t>=300||!o&&204!==t||o&&!Array.isArray(o.handle)){var i=o?JSON.stringify(o,null,2):r;throw new Error(ti+" status code "+t+" and "+(i?"response body:\n"+i:"no response body."))}if(o){var a=o.warnings,c=void 0===a?[]:a,u=o.errors,s=void 0===u?[]:u;c.forEach((function(e){n.warn(ti+" warning:",e)})),s.forEach((function(e){n.error(ti+" non-fatal error:",e)}))}}}({logger:o}),h=function(e){var n=e.logger;return function(e){if(e){var t=e.split(";");if(t.length>=2&&t[1].length>0)try{var r=parseInt(t[1],10);if(!isNaN(r))return{regionId:r}}catch(e){}n.warn('Invalid adobe edge: "'+e+'"')}return{}}}({logger:o}),y=function(e){var n=e.extractEdgeInfo;return function(e){var t=e.content,r=void 0===t?{}:t,o=e.getHeader,i=r.handle,a=void 0===i?[]:i,c=r.errors,u=void 0===c?[]:c,s=r.warnings,d=void 0===s?[]:s;return{getPayloadsByType:function(e){return ie(a.filter((function(n){return n.type===e})),(function(e){return e.payload}))},getErrors:function(){return u},getWarnings:function(){return d},getEdge:function(){return n(o("x-adobe-edge"))},toJSON:function(){return r}}}}({extractEdgeInfo:h}),w=ri({orgId:s,cookieJar:p}),C=function(e){var n=e.config,t=e.lifecycle,r=e.cookieTransfer,o=e.sendNetworkRequest,i=e.createResponse,a=e.processWarningsAndErrors,c=e.getLocationHint,u=e.getAssuranceValidationTokenParams,s=n.edgeDomain,d=n.edgeBasePath,f=n.edgeConfigId;return function(e){var n=e.request,l=e.runOnResponseCallbacks,g=void 0===l?ye:l,p=e.runOnRequestFailureCallbacks,v=void 0===p?ye:p,m=b();m.add(t.onResponse),m.add(g);var h=b();return h.add(t.onRequestFailure),h.add(v),t.onBeforeRequest({request:n,onResponse:m.add,onRequestFailure:h.add}).then((function(){var e=n.getUseIdThirdPartyDomain()?"adobedc.demdex.net":s,t=c(),i="https://"+e+"/"+(t?d+"/"+t:d)+"/v1/"+n.getAction()+"?configId="+f+"&requestId="+n.getId()+u();return r.cookiesToPayload(n.getPayload(),e),o({requestId:n.getId(),url:i,payload:n.getPayload(),useSendBeacon:n.getUseSendBeacon()})})).then((function(e){return a(e),e})).catch(ni(h)).then((function(e){var n=e.parsedBody,t=e.getHeader,o=i({content:n,getHeader:t});return r.responseToCookies(o),m.call({response:o}).then(ei)}))}}({config:t,lifecycle:c,cookieTransfer:l,sendNetworkRequest:v,createResponse:y,processWarningsAndErrors:m,getLocationHint:w,getAssuranceValidationTokenParams:yi}),E=function(e){var n=e.cookieTransfer,t=e.lifecycle,r=e.createResponse,o=e.processWarningsAndErrors;return function(e){var i=e.request,a=e.responseHeaders,c=e.responseBody,u=e.runOnResponseCallbacks,s=void 0===u?ye:u,d=e.runOnRequestFailureCallbacks,f=void 0===d?ye:d,l=b();l.add(t.onResponse),l.add(s);var g=b();g.add(t.onRequestFailure),g.add(f);var p=function(e){return a[e]};return t.onBeforeRequest({request:i,onResponse:l.add,onRequestFailure:g.add}).then((function(){return o({statusCode:200,getHeader:p,body:JSON.stringify(c),parsedBody:c})})).catch(ni(g)).then((function(){var e=r({content:c,getHeader:p});return n.responseToCookies(e),l.call({response:e}).then(ei)}))}}({lifecycle:c,cookieTransfer:l,createResponse:y,processWarningsAndErrors:m}),I=function(e){var n=e.generalConsentState,t=e.logger,r=function(e,r){switch(e.general){case Sn:n.in(r);break;case"out":n.out(r);break;case On:n.pending(r);break;default:t.warn("Unknown consent value: "+e.general)}};return{initializeConsent:function(e,n){n.general?r(n,xn):r(e,qn)},setConsent:function(e){r(e,Mn)},suspend:function(){n.pending()},awaitConsent:function(){return n.awaitConsent()},withConsent:function(){return n.withConsent()}}}({generalConsentState:Nn({logger:o}),logger:o}),D=function(e){var n=e.config,t=e.logger,r=e.lifecycle,o=e.consent,i=e.createEvent,a=e.createDataCollectionRequestPayload,c=e.createDataCollectionRequest,u=e.createFetchRequestPayload,s=e.createFetchRequest,d=e.sendEdgeNetworkRequest,f=e.applyResponse,l=n.onBeforeEventSend,g=n.edgeConfigOverrides;return{createEvent:i,sendEvent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.renderDecisions,u=void 0!==i&&i,s=n.decisionScopes,f=n.edgeConfigOverrides,p=n.personalization,v=a(),m=c(v),h=b(),y=b();return v.mergeConfigOverride(g),v.mergeConfigOverride(f),r.onBeforeEvent({event:e,renderDecisions:u,decisionScopes:s,personalization:p,onResponse:h.add,onRequestFailure:y.add}).then((function(){return v.addEvent(e),o.awaitConsent()})).then((function(){try{e.finalize(l)}catch(o){var n=function(){throw o};return y.add(r.onRequestFailure),y.call({error:o}).then(n,n)}if(!e.shouldSend()){y.add(r.onRequestFailure),t.info(Yo);var o=new Error(Yo);return y.call({error:o}).then((function(){}))}return d({request:m,runOnResponseCallbacks:h.call,runOnRequestFailureCallbacks:y.call})}))},applyResponse:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.renderDecisions,o=void 0!==t&&t,i=n.responseHeaders,u=void 0===i?{}:i,s=n.responseBody,d=void 0===s?{handle:[]}:s,l=a(),g=c(l),p=b();return r.onBeforeEvent({event:e,renderDecisions:o,decisionScopes:[Mt],personalization:{},onResponse:p.add,onRequestFailure:ye}).then((function(){return l.addEvent(e),f({request:g,responseHeaders:u,responseBody:d,runOnResponseCallbacks:p.call})}))},fetch:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.renderDecisions,i=void 0!==t&&t,a=n.edgeConfigOverrides,c=n.personalization,f=u(),l=s(f),p=b(),v=b();return f.mergeConfigOverride(g),f.mergeConfigOverride(a),r.onBeforeFetch({event:e,renderDecisions:i,personalization:c,onResponse:p.add,onRequestFailure:v.add}).then((function(){return f.addEvent(e),o.awaitConsent()})).then((function(){return e.finalize(),d({request:l,runOnResponseCallbacks:p.call,runOnRequestFailureCallbacks:v.call})}))}}}({config:t,logger:o,lifecycle:c,consent:I,createEvent:Tn,createDataCollectionRequestPayload:st,createDataCollectionRequest:at,createFetchRequestPayload:ft,createFetchRequest:dt,sendEdgeNetworkRequest:C,applyResponse:E});return function(e){var n=e.componentCreators,t=e.lifecycle,r=e.componentRegistry,o=e.getImmediatelyAvailableTools;return n.forEach((function(e){var n,t=e.namespace,i=o(t);try{n=e(i)}catch(e){throw Pe({error:e,message:"["+t+"] An error occurred during component creation."})}r.register(t,n)})),t.onComponentsRegistered({lifecycle:t}).then((function(){return r}))}({componentCreators:Qo,lifecycle:c,componentRegistry:a,getImmediatelyAvailableTools:function(e){var r=i(e);return{config:t,componentRegistry:a,consent:I,eventManager:D,fireReferrerHideableImage:hi,logger:r,lifecycle:c,sendEdgeNetworkRequest:C,handleError:Go({errorPrefix:"["+n+"] ["+e+"]",logger:r}),createNamespacedStorage:ci,apexDomain:vi}}})},setDebugCommand:function(e){r(e.enabled,{fromConfig:!1})},handleError:s,validateCommandOptions:Fn});return d};(Wo=window.__alloyNS)&&Wo.forEach((function(e){var n=Cn({console:si,locationSearch:window.location.search,createLogger:Ko,instanceName:e,createNamespacedStorage:ci,getMonitors:gi}),t=function(e){return function(n){var t=n[0],r=n[1],o=n[2],i=o[0],a=o[1];e(i,a).then(t,r)}}(wi({instanceName:e,logController:n})),r=window[e].q;r.push=t,n.logger.logOnInstanceCreated({instance:t}),r.forEach(t)}))}function bi(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Ci(e,n){return e(n={exports:{}},n.exports),n.exports}function Ei(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ii(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ei(Object(t),!0).forEach((function(n){Ri(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ei(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Di(e){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(e)}function Ri(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Si(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function Oi(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var r,o,i=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==t.return||t.return()}finally{if(c)throw o}}return i}(e,n)||Pi(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ki(e){return function(e){if(Array.isArray(e))return qi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Pi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pi(e,n){if(e){if("string"==typeof e)return qi(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?qi(e,n):void 0}}function qi(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function xi(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function Mi(e){return Boolean(e&&void 0!==e.length)}function Ai(){}function Ni(e){if(!(this instanceof Ni))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Hi(e,this)}function Ti(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,Ni._immediateFn((function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var r;try{r=t(e._value)}catch(e){return void Ui(n.promise,e)}ji(n.promise,r)}else(1===e._state?ji:Ui)(n.promise,e._value)}))):e._deferreds.push(n)}function ji(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===Di(n)||"function"==typeof n)){var t=n.then;if(n instanceof Ni)return e._state=3,e._value=n,void Fi(e);if("function"==typeof t)return void Hi(function(e,n){return function(){e.apply(n,arguments)}}(t,n),e)}e._state=1,e._value=n,Fi(e)}catch(n){Ui(e,n)}}function Ui(e,n){e._state=2,e._value=n,Fi(e)}function Fi(e){2===e._state&&0===e._deferreds.length&&Ni._immediateFn((function(){e._handled||Ni._unhandledRejectionFn(e._value)}));for(var n=0,t=e._deferreds.length;n<t;n++)Ti(e,e._deferreds[n]);e._deferreds=null}function Bi(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function Hi(e,n){var t=!1;try{e((function(e){t||(t=!0,ji(n,e))}),(function(e){t||(t=!0,Ui(n,e))}))}catch(e){if(t)return;t=!0,Ui(n,e)}}}();
